<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"><html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"></meta><link href="v8help://service_book/service_style" type="text/css" rel="stylesheet"></link><meta content="MSHTML 6.00.6000.16587" name="GENERATOR"></meta></head><body>
<h1>Настройка структуры отчета</h1>
<p>Настройка структуры отчета может производится в двух режимах: простой настройки и расширенной. Переход из простой в расширенную возможен всегда, обратный переход возможет только в том случае, если простой режим настройки способен отобразить настройки, указанные в расширенном режиме.</p>
<h2>Настройка структуры отчета в режиме простой настройки </h2>
<h5 class="">Доступные поля</h5>
<p class="">Отображаются поля, доступные в отчете. Из доступных полей поля можно перетаскивать в остальные табличные поля: группировка строк, группировка колонок, колонки отчета, отбор, сортировка.</p>
<h5 class="">Представление отчета</h5>
<p>Кнопкой в левом верхнем углу можно переключать представление отчета:</p>
<li>таблица 
</li><li>кросс-таблица, 
</li><li>диаграмма 
<p>В зависимости от выбранного представления отображаются различные табличные поля: для таблицы отображаются группировки строк и колонки отчета, для кросс-таблицы группировки строк, группировки колонок и колонки отчета, для диаграммы отображаются серии, точки и показатели.</p>
<h5 class="">Закладка "Структура отчета"</h5>
<ul><li>
<div class="">Группировки строк - представлены аналитические разрезы, по которым необходимо детализировать и группировать в строках данные отчета.</div>
</li><li>
<div class="">Группировки строк - представлены аналитические разрезы, по которым необходимо детализировать и группировать в колонках данные отчета.</div>
</li><li>
<div class="">Колонки отчета - поля отчета, которые необходимо выводить в колонках отчета.</div>
</li><li>
<div class="">Серии и точки - соответствующие измерения для диаграммы.</div>
</li><li>
<div class="">Показатели - указывается один показатель, необходимый для вывода в диаграмму.</div></li></ul><h5 class="">Закладка "Отбор и сортировка (и параметры)"</h5>
<ul><li>
<div class="">Отбор - накладываются условия на выводимые данные</div>
</li><li>
<div class="">Сортировка - указываются критерии сортировки данных при выводе отчета</div>
</li><li>
<div class="">Параметры - данные, влияющие на выводимые данные отчета.</div></li></ul><h5 class="">Закладка "Оформление"</h5>
<p class="">На закладке "Оформление" отображается условное оформление отчета. При настройке таблицы или кросс-таблицы также доступны настройки "Отрицательное красным" и "Выводить общие итоги".</p>
<h5 class="">Дополнительная настройка</h5>
<p class="">При нажатии на кнопку "Дополнительная настройка" можно настроить расшифровку отчета.</p>
<h2>
<h5 class="">Настройка пользовательских полей</h5></h2>
<p class="">При нажатии кнопки "Настройка пользовательских полей" открывается форма настройки пользовательских полей</p>
<h2>
</h2><p class="">Настройка структуры отчета в режиме расширенной настройки </p>
<p>Настройки схемы компоновки данных могут содержать структуру, включающую в себя доступные элементы настроек. Такими элементами являются:</p>
<ul><li>группировка; 
</li><li>таблица; 
</li><li>диаграмма; 
</li><li>вложенный отчет. </li></ul><p>Для группировки доступны следующие настройки:</p>
<ul><li><strong>Флаг использования группировки</strong> - если установлен - группировка используется при компоновке; 
</li><li><strong>Поля группировки </strong>- набор полей, по которым осуществляется группировка. Каждое поле группировки системы компоновки данных обладает следующими свойствами: 
<ul><li><strong>Флаг использования поля</strong> - если установлен - поле используется; 
</li><li><strong>Поле группировки</strong> - путь к данным поля, по которому осуществляется группировка; 
</li><li><strong>Тип группировки</strong> – тип группировки (<strong>Иерархия</strong>, <strong>Только иерархия</strong>, <strong>Элементы</strong>); 
</li><li><strong>Тип дополнения</strong> – необходимость дополнения дат в периоде; 
</li><li><strong>Начальная дата</strong> - начальная дата периода. Может содержать константное значение, либо значение – поле; 
</li><li><strong>Конечная дата</strong> - конечная дата периода. Может содержать константное значение, либо значение - поле; </li></ul></li><li><strong>Выбранные поля</strong> - см. выбранные поля; 
</li><li><strong>Отбор</strong> - см. отбор; 
</li><li><strong>Порядок</strong> - см. порядок; 
</li><li><strong>Условное оформление</strong> - см. условное оформление; 
</li><li><strong>Параметры вывода</strong> - см. параметры вывода. Группировка диаграммы не имеет параметров вывода; </li></ul><p>Для таблицы доступны следующие настройки:</p>
<ul><li><strong>Флаг использования таблицы</strong> - если установлен - таблица используется при компоновке; 
</li><li><strong>Колонки</strong> - коллекция значений, определяющая колонки таблицы; 
</li><li><strong>Строки</strong> - коллекция значений, определяющая строки таблицы; 
</li><li><strong>Выбранные поля</strong> - см. выбранные поля; 
</li><li><strong>Условное оформление</strong> - см. условное оформление; 
</li><li><strong>Параметры вывода</strong> - см. параметры вывода. </li></ul><p>Для диаграммы доступны следующие настройки:</p>
<ul><li><strong>Флаг использования диаграммы</strong> - если установлен - диаграмма используется при компоновке; 
</li><li><strong>Точки</strong> - коллекция значений, определяющая точки диаграммы; 
</li><li><strong>Серии</strong> - коллекция значений, определяющая серии диаграммы; 
</li><li><strong>Выбранные поля</strong> - выбранные поля определяют ресурсы, выводимые в диаграмму при компоновке (см. выбранные поля); 
</li><li><strong>Условное оформление</strong> - см. условное оформление; 
</li><li><strong>Параметры вывода</strong> - см. параметры вывода. </li></ul><h3 class="">Табличное поле структуры отчета</h3>
<p>Содержание отчета формируется на закладке "Настройки" конструктора схемы компоновки данных в табличном поле структуры отчета. Рядом с каждым элементом в структуре можно поставить пометку. Если пометка установлена, элемент выводится в результат отчета.</p>
<p>Для добавления новой группировки используйте команду "Новая группировка". В открывшемся диалоге следует выбрать поле группировки и тип группировки. Если поле группировки не задается, то в ней будут выводиться детальные записи и она будет называться "&lt;Детальные записи&gt;".</p>
<p>При добавлении новой группировки, в ее параметрах автоматически добавляются поля автопорядка и автовыбора. При добавлении новой диаграммы – автовыбор. </p>
<p>Для группировки выбранных записей по заданному полю в контекстном меню элемента структуры отчета следует выбрать команду "Сгруппировать", в диалоге выбрать поле группировки и тип группировки (возможен выбор иерархической группировки и группировки по элементам). При этом, если группируемый элемент уже содержит поле автопорядка, то оно войдет и в новую группировку. Если создание группировки потеряло смысл, нажмите "Отмена".</p>
<p>Если по полю проводится иерархическая или только иерархическая группировка, в структуре отчета после заголовка поля в скобках отобразится тип иерархии. </p>
<p>Для изменения текущей группировки используйте команду "Изменить". С помощью этой команды можно выбрать иное поле группировки и тип группировки для текущей группировки.</p>
<p>Для удаления элемента из структуры отчета, следует выбрать его, нажать Del и подтвердить удаление.</p>
<p>Для переключения режима настройки данных следует использовать команды "Текущий отчет" и "Текущий элемент отчета".</p>
<h3 class="">Возможности настройки схемы компоновки данных</h3>
<p>В зависимости от вида выбранного элемента структуры отчета меняется состав параметров настройки. При добавлении отбора, сортировки, условного оформления и пр. в текущей строке табличного поля структуры отчета появится соответствующая пиктограмма. В настройках схемы компоновки данных, по умолчанию, везде, где используются поля, отображаются не заголовки полей, а пути к данным этих полей.</p>
<h4 class="">Режим настройки "Текущий отчет"</h4>
<p>В этом режиме доступны закладки: "Параметры данных" (если для схемы был задан хотя бы один параметр), "Выбранные поля", "Отбор", "Сортировка", "Условное оформление", "Пользовательские поля", "Другие настройки"</p>
<h4 class="">Режим настройки "Текущий элемент структуры настроек"</h4>
<p>В этом режиме доступны закладки:</p>
<ul><li>Для элемента типа "Группировка": 
<ul><li>Поля группировки 
</li><li>Выбранные поля 
</li><li>Отбор 
</li><li>Сортировка 
</li><li>Условное оформление 
</li><li>Другие настройки</li></ul></li><li>Для элементов типа "Таблица" и "Диаграмма": 
<ul><li>Выбранные поля 
</li><li>Условное оформление 
</li><li>Другие настройки</li></ul></li></ul><p>Если на закладке "Параметры" конструктора схемы компоновки данных были заданы поля – параметры, то они отобразятся в списке доступных полей в папке "Параметры Данных". В тех местах, где будут использоваться эти поля, при выполнении отчета будет подставляться значение соответствующих параметров. Поля – параметры могут использоваться в любом месте настроек, кроме отбора и группировки. Если на поле – параметр наложено условное оформление, оно будет применяться к параметру при выводе его значения в результат компоновки.</p>
<p>В качестве параметров могут быть использованы предопределенные данные и перечисления (в режиме Конфигуратора).</p>
<p>На закладке "Выбранные поля" выбираются поля, которые будут входить в результат компоновки. Имеется возможность с помощью меню или контекстного меню добавить Новое поле, Новую папку полей, Новое автополе.</p>
<p>На закладке "Поля группировки" выбираются поля, по которым будет проводиться группировка и тип группировки. Имеется возможность с помощью меню или контекстного меню добавить Новое поле, Новое автополе.</p>
<p>На закладке "Отбор" выбираются поля для фильтрации записей результата компоновки. С помощью меню или контекстного меню можно добавить Новый элемент или Новую группу. В колонках этой закладки добавленному элементу можно установить значение, по которому будет проводиться отбор записей результата компоновки. Можно использоваться предопределенные данные и перечисления (в режиме Конфигуратора).</p>
<p>На закладке "Сортировка" выбираются поля, по которым результат выполнения отчета будет отсортирован. Возможно добавление как "элемента порядка", так и "авто элемента порядка". Для авто элемента порядка в контекстном меню есть команда "Развернуть". При развороте авто элемента, когда в порядок добавляются элементы, соответствующие полям группировки, система проверяет наличие реквизитов этих полей в глобальном упорядочивании. Если они присутствуют, то они добавляются в упорядочивание вместо поля группировки.</p>
<p>На закладках "Поля группировки", "Выбранные поля", "Отбор", "Сортировка" из списка доступных полей можно переносить в окно выбора поле или непрерывную группу полей с помощью стандартного механизма перетаскивания. Также, используя контекстное меню списка доступных полей можно выбрать текущее или все поля для того, чтобы поместить их в соответствующую коллекцию (команда "Выбрать все"). </p>
<p>Доступные поля настройки компоновки данных отображаются в последовательности: вначале поля - не ресурсы по алфавиту заголовка, после них поля – ресурсы по алфавиту заголовка, и в конце списка – системные папки.</p>
<p>На закладке "Пользовательские поля" можно задать пользовательские поля (выбор или выражение), которые выводятся в результат компоновки. Полю-выбор следует задать Заголовок и выражение отбора, значение и представление. Полю-выражению можно задать Заголовок и выражения для детальных и итоговых записей.</p>
<p>Если полю или параметру установлен список доступных значений, то в настройках компоновки данных для параметра можно будет выбрать значение из этого списка, а в настройке отбора для поля можно будет выбрать значение поля из его списка доступных значений. При выводе значения параметра или поля, имеющих доступные значения, в результат компоновки вместо значения будет выводиться его представление из списка доступных значений.</p>
<p><strong>Примечание</strong>. По умолчанию, везде, где используются поля, отображаются не заголовки полей, а пути к данным этих полей.</p>
<p>На закладке "Условное оформление" можно задавать "специфическое оформление" элементам компоновки.</p>
<p>На закладке "Другие параметры" в режиме "Текущий отчет" задаются параметры вывода отчета, в режиме "Текущий элемент..." задаются специфические параметры вывода элементов отчета.</p>
<p>На закладках "Отбор" и "Условное оформление" по кнопке "Подробно" становится доступной колонка "Представление", в которой отображаемым полям можно задавать имена, с которыми они будут выводиться в результат отчета.</p>
<p>Команда "Стандартная настройка" сменит все пользовательские изменения настроек отчета на стандартные. </p>
<p><strong>Примечание 1</strong>. Если вложенный отчет был изменен на вкладке "Вложенные схемы", чтобы изменения отразились в составляемом отчете, нужно удалить старый отчет и добавить новый.</p>
<p><strong>Примечание 2</strong>. При генерации макета компоновки, система выдаст ошибку, если во вложенном отчете используется поле верхнего отчета, значение которого невозможно определить. Это происходит в случаях, когда отчет вложен в группировку по данному полю, либо когда отчет вложен в детальные записи.</p>
<p><strong>Примечание 3</strong>. При размещении диаграммы в структуре отчета следует иметь в виду, что при выборе вида диаграммы "Круговая" если не заданы серии, но заданы точки, то в качестве серий системой будут автоматически использоваться точки. А при выборе вида диаграммы "График" если не заданы точки, но заданы серии, то в качестве точек будут использоваться серии.</p></li></body></html>