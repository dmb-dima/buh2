

Процедура КоманднаяПанель1СохранитьВФайл(Кнопка = Неопределено)
	Диалог = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Сохранение);
	Диалог.Заголовок = "Save as";
	Диалог.ПолноеИмяФайла = СтрЗаменить(ЭтаФорма.Заголовок,".","");
	Диалог.ПредварительныйПросмотр = Ложь;
	Диалог.Фильтр = ПолучитьФильтрФайлов();
	Если Диалог.Выбрать() Тогда
		ИмяФайла = Диалог.ПолноеИмяФайла;
		Попытка
			ЭлементыФормы.ПолеДокумента.Записать(ИмяФайла, ?(Прав(ИмяФайла,3) = "xls", ТипФайлаТабличногоДокумента.XLS, ТипФайлаТабличногоДокумента.MXL));
		Исключение
			Предупреждение("Ошибка при записи. Файл не записан.");
		КонецПопытки;		
	КонецЕсли;
КонецПроцедуры

// Формирует строку фильтра для диалога выбора файла с типами файлов.
//
// Параметры
//  Нет.
//
// Возвращаемое значение:
//   Строка – фильтр по типам файлов для диалога выбора файла.
//
Функция ПолучитьФильтрФайлов() Экспорт

	Возврат "Табличный документ (*.mxl)|*.mxl|"
	      + "Документ Microsoft Excel (*.xls)|*.xls|";

КонецФункции // ПолучитьФильтрФайлов()

Процедура КоманднаяПанель1Печать(Кнопка)
	ЭлементыФормы.ПолеДокумента.КоличествоЭкземпляров = КоличествоКопий; 
	ЭлементыФормы.ПолеДокумента.Напечатать(Истина);
КонецПроцедуры

Процедура ПриОткрытии()
	
	//ЭлементыФормы.КоманднаяПанель1.Кнопки.ТолькоПросмотр.Доступность = ЗначениеЗаполнено(Документ);
	//ЭлементыФормы.ПолеДокумента.ТолькоПросмотр = ЗначениеЗаполнено(Документ);
	
	ОбновитьДанные();
	
	ЭлементыФормы.ПолеДокумента.ОтображатьЗаголовки = Ложь;
	ЭлементыФормы.ПолеДокумента.ОтображатьСетку     = Ложь;
	ЭлементыФормы.ПолеДокумента.Защита              = Ложь;
	ЭлементыФормы.ПолеДокумента.ТолькоПросмотр      = Истина;
	ЭлементыФормы.ПолеДокумента.АвтоМасштаб         = ПечатныйДокумент.АвтоМасштаб;
	ЭлементыФормы.ПолеДокумента.ОриентацияСтраницы  = ПечатныйДокумент.ОриентацияСтраницы;
	ЭлементыФормы.ПолеДокумента.ПолеСверху          = ПечатныйДокумент.ПолеСверху;
	ЭлементыФормы.ПолеДокумента.ПолеСнизу           = ПечатныйДокумент.ПолеСнизу;
	ЭлементыФормы.ПолеДокумента.ПолеСлева           = ПечатныйДокумент.ПолеСлева;
	ЭлементыФормы.ПолеДокумента.ПолеСправа          = ПечатныйДокумент.ПолеСправа;
	ЭлементыФормы.ПолеДокумента.РазмерКолонтитулаСверху = ПечатныйДокумент.РазмерКолонтитулаСверху;
	ЭлементыФормы.ПолеДокумента.РазмерКолонтитулаСнизу  = ПечатныйДокумент.РазмерКолонтитулаСнизу;
	ЭлементыФормы.ПолеДокумента.ИмяПараметровПечати = ПечатныйДокумент.ИмяПараметровПечати;
	ЭлементыФормы.ПолеДокумента.ЧерноБелыйПросмотр  = Ложь;
	ЭлементыФормы.ПолеДокумента.ЧерноБелаяПечать    = Истина;
	ЭлементыФормы.ПолеДокумента.ПовторятьПриПечатиСтроки = ПечатныйДокумент.ПовторятьПриПечатиСтроки;
	
	ЭлементыФормы.КоманднаяПанель1.Кнопки.ТолькоПросмотр.Пометка = Истина;
	
	КоличествоКопий = Макс(ЭлементыФормы.ПолеДокумента.КоличествоЭкземпляров, 1);
	
КонецПроцедуры


Процедура КоманднаяПанель1Изменить(Кнопка)
	//ЭлементыФормы.ПолеДокумента.Защита              = НЕ ЭлементыФормы.ПолеДокумента.Защита;
	ЭлементыФормы.ПолеДокумента.ТолькоПросмотр      = НЕ ЭлементыФормы.ПолеДокумента.ТолькоПросмотр;
	ЭлементыФормы.КоманднаяПанель1.Кнопки.ТолькоПросмотр.Пометка = НЕ ЭлементыФормы.КоманднаяПанель1.Кнопки.ТолькоПросмотр.Пометка;
КонецПроцедуры


Процедура ПриПовторномОткрытии(СтандартнаяОбработка)
	
	ОбновитьДанные();
	
КонецПроцедуры

Процедура ОбновитьДанные()
	
	ЭлементыФормы.ПолеДокумента.ВставитьОбласть(ПечатныйДокумент.Область());
	
КонецПроцедуры


