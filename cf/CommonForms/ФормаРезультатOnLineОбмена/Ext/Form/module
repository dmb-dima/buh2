
Процедура ОткрытиеТекстаДляПросмотра(Текст)
	
	ФормаРедактированияТекста = ПолучитьОбщуюФорму("ФормаРедактированияТекста", ЭтаФорма, Строка(Новый УникальныйИдентификатор));
	ФормаРедактированияТекста.УстановитьРедактируемыйТекст(Текст);
	ФормаРедактированияТекста.Открыть();		
		
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если НаборЗаписейИстории.Количество() = 0 Тогда
		Отказ = истина;
		Возврат;
	КонецЕсли;
	
	СтрокаИстории = НаборЗаписейИстории[0];
	
	ЗагрузкаДанных = СтрокаИстории.КомментарийКЗагрузкеДанных;
	
	Если СтрокаИстории.РезультатПоследнейЗагрузки = Истина Тогда
		
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяЗагрузка.Картинка = БиблиотекаКартинок.ВыполненоУспешно32;
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяЗагрузка.Видимость = Истина;
				
	ИначеЕсли СтрокаИстории.РезультатПоследнейЗагрузки = Ложь Тогда
		
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяЗагрузка.Картинка = БиблиотекаКартинок.ВыполненоСОшибками32;
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяЗагрузка.Видимость = Истина;
				
	Иначе
		
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяЗагрузка.Видимость = Ложь;
		ЭлементыФормы.НадписьПодробноЗагрузка.Заголовок = "Не производилось";
		
		ЕстьКомментарийКЗагрузке = ЗначениеЗаполнено(ЗагрузкаДанных);
		ЭлементыФормы.НадписьПодробноЗагрузка.ГиперСсылка = ЕстьКомментарийКЗагрузке;
		Если НЕ ЕстьКомментарийКЗагрузке Тогда
						
			ЗагрузкаДанных = "Не производилось";
			
		КонецЕсли;
		
	Конецесли;
	
	ВыгрузкаДанных = СтрокаИстории.КомментарийКВыгрузкеДанных;
	
	Если СтрокаИстории.РезультатПоследнейВыгрузки = Истина Тогда
		
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяВыгрузка.Картинка = БиблиотекаКартинок.ВыполненоУспешно32;
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяВыгрузка.Видимость = Истина;		
		
	ИначеЕсли СтрокаИстории.РезультатПоследнейВыгрузки = Ложь Тогда
		
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяВыгрузка.Картинка = БиблиотекаКартинок.ВыполненоСОшибками32;
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяВыгрузка.Видимость = Истина;
				
	Иначе
		
		ЭлементыФормы.ПолеКартинкиПоследняяУдачнаяВыгрузка.Видимость = Ложь;
		ЭлементыФормы.НадписьПодробноВыгрузка.Заголовок = "Не производилось";
		
		ЕстьКомментарийКВыгрузке = ЗначениеЗаполнено(ВыгрузкаДанных);
		ЭлементыФормы.НадписьПодробноВыгрузка.ГиперСсылка = ЕстьКомментарийКВыгрузке;
		Если Не ЕстьКомментарийКВыгрузке Тогда
			ВыгрузкаДанных = "Не производилось";
		КонецЕсли;
		
	Конецесли;
	
	ОтложенныеДвижения = СтрокаИстории.КомментарийКОтложенномуДвижениюДокументов;
	
	Если СтрокаИстории.РезультатОтложенныхДвиженийДокументов = Истина Тогда
		
		ЭлементыФормы.ПолеКартинкиПоследнееУдачноеДвижениеДокументов.Картинка = БиблиотекаКартинок.ВыполненоУспешно32;
		ЭлементыФормы.ПолеКартинкиПоследнееУдачноеДвижениеДокументов.Видимость = Истина;		
		
	ИначеЕсли СтрокаИстории.РезультатОтложенныхДвиженийДокументов = Ложь Тогда
		
		ЭлементыФормы.ПолеКартинкиПоследнееУдачноеДвижениеДокументов.Картинка = БиблиотекаКартинок.ВыполненоСОшибками32;
		ЭлементыФормы.ПолеКартинкиПоследнееУдачноеДвижениеДокументов.Видимость = Истина;
				
	Иначе
		
		ЭлементыФормы.ПолеКартинкиПоследнееУдачноеДвижениеДокументов.Видимость = Ложь;
		ЭлементыФормы.НадписьПодробноПроведение.Заголовок = "Не производилось";
		
		ЕстьКомментарийКДвижениям = ЗначениеЗаполнено(ОтложенныеДвижения);
		
		ЭлементыФормы.НадписьПодробноПроведение.ГиперСсылка = ЕстьКомментарийКДвижениям;
		Если Не ЕстьКомментарийКДвижениям Тогда
			ОтложенныеДвижения = "Не производилось";
		КонецЕсли;
		
	Конецесли;
	
	Если ПустаяСтрока(ЗагрузкаДанных) Тогда
		ЗагрузкаДанных = "Загрузка выполнена успешно";
	КонецЕсли;
	
	Если ПустаяСтрока(ВыгрузкаДанных) Тогда
		ВыгрузкаДанных = "Выгрузка выполнена успешно";
	КонецЕсли;	
	
	Если ПустаяСтрока(ОтложенныеДвижения) Тогда
		ОтложенныеДвижения = "Отложенные движения документов выполнены успешно";
	КонецЕсли;
	
КонецПроцедуры

Процедура ОсновныеДействияФормыОК(Кнопка)
	
	Закрыть();
	
КонецПроцедуры

Процедура НадписьПодробноЗагрузкаНажатие(Элемент)
	
	ОткрытиеТекстаДляПросмотра(ЗагрузкаДанных);
	
КонецПроцедуры

Процедура НадписьПодробноВыгрузкаНажатие(Элемент)
	
	ОткрытиеТекстаДляПросмотра(ВыгрузкаДанных);
	
КонецПроцедуры

Процедура НадписьПодробноПроведениеНажатие(Элемент)
	
	ОткрытиеТекстаДляПросмотра(ОтложенныеДвижения);
	
КонецПроцедуры
