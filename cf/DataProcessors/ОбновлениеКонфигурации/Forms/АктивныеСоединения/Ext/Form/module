Процедура ОбновитьСписокАктивныхСоединений()
	
	АктивныеСоединения.Очистить();
	
	МассивСоединений = ПолучитьСоединенияИнформационнойБазы();
	
	Для Каждого Соединение Из МассивСоединений Цикл
		
		// Текущее соединение не выводится в список.
		Если Соединение.НомерСоединения = НомерСоединенияИнформационнойБазы() Тогда 
			Продолжить;
		КонецЕсли;
		
		ИмяПриложения = Соединение.ИмяПриложения;
		Если ИмяПриложения = "1CV8" Тогда
			ИмяПриложения = "1С:Предприятие";
		ИначеЕсли ЭтоСоединениеКонфигуратором(Соединение) Тогда
			ИмяПриложения = "Конфигуратор";
		ИначеЕсли ЭтоCOMСоединение(Соединение) Тогда
			ИмяПриложения = "Внешнее соединение";
		КонецЕсли;
			
		НоваяСтрока = АктивныеСоединения.Добавить();
		НоваяСтрока.Пользователь  = ?(Соединение.Пользователь = Неопределено, "<Не авторизован>", Соединение.Пользователь.Имя);
		НоваяСтрока.ИмяКомпьютера = Соединение.ИмяКомпьютера;
		НоваяСтрока.ИмяПриложения = ИмяПриложения;
		
	КонецЦикла;
	
КонецПроцедуры


Процедура КнопкаОКНажатие(Кнопка)
	
	Закрыть();
	
КонецПроцедуры // КнопкаОКНажатие()


Процедура ПриОткрытии()
	
	ОбновитьСписокАктивныхСоединений();
	
	ПодключитьОбработчикОжидания("ОжиданиеЗакрытияСоединений", 3);
	
КонецПроцедуры


Процедура ОжиданиеЗакрытияСоединений()
	
	ОбновитьСписокАктивныхСоединений();
	
КонецПроцедуры 
