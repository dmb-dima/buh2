////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ


////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Обработчк события "ПриОткрытии" формы.
// Заполняет список валют и текущие курсы.
//
Процедура ПриОткрытии()
	
	ОбновитьСписокВалют();
	
	НачДата = НачалоМесяца(ТекущаяДата());
	КонДата = КонецМесяца(ТекущаяДата());
	
КонецПроцедуры // ПриОткрытии()

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ, ВЫЗЫВАЕМЫЕ ИЗ ЭЛЕМЕНТОВ ФОРМЫ

// Обработчик события "Нажатие" кнопки "ВыбПериод"
Процедура ВыбПериодНажатие(Элемент)
	
	НастройкаПериода = Новый НастройкаПериода;
	НастройкаПериода.УстановитьПериод(НачДата, КонецДня(КонДата));
	НастройкаПериода.РедактироватьКакИнтервал = Истина;
	НастройкаПериода.РедактироватьКакПериод = Истина;
	НастройкаПериода.ВариантНастройки = ВариантНастройкиПериода.Период;
	НастройкаПериода.Редактировать();
	
	НачДата = НастройкаПериода.ПолучитьДатуНачала();
	КонДата = НастройкаПериода.ПолучитьДатуОкончания();
	
КонецПроцедуры // ВыбПериодНажатие()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ДЕЙСТВИЯ КОМАНДНЫХ ПАНЕЛЕЙ ФОРМЫ

// Обработчик действия "Загрузить" элемента формы КоманднаяПанельФормы.
// Загружает курсы валют.
//
Процедура КоманднаяПанельФормыЗагрузить(Кнопка)
	
	ЭлементыФормы.ТекстЗавершения.Видимость = Ложь;
	
	ЗагрузитьКурсыВалют();
	
	ОбновитьСписокВалют();
	
	ЭлементыФормы.ТекстЗавершения.Видимость = Истина;
	
КонецПроцедуры // КоманднаяПанельФормыЗагрузить()

// Обработчик действия "УстановитьФлажки" элемента формы КоманднаяПанельВалюты.
// Устанавливает признак загрузки курса всем строкам таблицы.
//
Процедура КоманднаяПанельВалютыУстановитьФлажки(Кнопка)
	
	Для Каждого Валюта Из СписокВалют Цикл
		Валюта.Загрузка = Истина;
	КонецЦикла;
	
КонецПроцедуры // КоманднаяПанельВалютыУстановитьФлажки()

// Обработчик действия "УстановитьФлажки" элемента формы КоманднаяПанельВалюты.
// Снимает признак загрузки курса всем строкам таблицы.
//
Процедура КоманднаяПанельВалютыСнятьФлажки(Кнопка)
	
	Для Каждого Валюта Из СписокВалют Цикл
		Валюта.Загрузка = Ложь;
	КонецЦикла;
	
КонецПроцедуры // КоманднаяПанельВалютыСнятьФлажки()












