
Процедура КнопкаВыполнитьНажатие(Кнопка)
	
	Если НЕ ЗначениеЗаполнено(ИмяФайлаДанных) Тогда
		Предупреждение("Не указан файл выгруженных данных.");	
		Возврат;
	Иначе
		Попытка
			ОбработкаОбмена = Обработки.УниверсальныйОбменДаннымиXML.Создать();
			ОбработкаОбмена.РежимОбмена = "Загрузка";
			ВыбФайл = Новый Файл(ИмяФайлаДанных);
			Если ВыбФайл.Существует() Тогда			
				ОбработкаОбмена.ИмяФайлаОбмена = ВыбФайл.ПолноеИмя;	
				ОбработкаОбмена.ВыполнитьЗагрузку();
				Предупреждение("Загрузка данных завершена.");
			Иначе
				Предупреждение("Не найдена информация о выгруженных данных.");
			КонецЕсли;
		Исключение
			Предупреждение("Не удалось инициализировать обработку загрузки данных.");				
		КонецПопытки;
	КонецЕсли;
	
КонецПроцедуры

Процедура ИмяФайлаДанныхОткрытие(Элемент, СтандартнаяОбработка)

	СтандартнаяОбработка = Ложь;
	
	ЗапуститьПриложение("explorer " + Элемент.Значение);

КонецПроцедуры

Процедура ИмяФайлаДанныхНачалоВыбора(Элемент, СтандартнаяОбработка)

	ВыборФайла(Элемент, Истина);

КонецПроцедуры

Процедура ВыборФайла(Элемент, ПроверятьСуществование=Ложь)

	ДиалогФыбораФайла = Новый ДиалогВыбораФайла(РежимДиалогаВыбораФайла.Открытие);

	ДиалогФыбораФайла.Фильтр                  = "Файл данных (*.xml)|*.xml";
	ДиалогФыбораФайла.Заголовок               = "Выберите файл";
	ДиалогФыбораФайла.ПредварительныйПросмотр = Ложь;
	ДиалогФыбораФайла.Расширение              ="xml";
	ДиалогФыбораФайла.ИндексФильтра           = 0;
	ДиалогФыбораФайла.ПолноеИмяФайла          = Элемент.Значение;
	ДиалогФыбораФайла.ПроверятьСуществованиеФайла = ПроверятьСуществование;

	Если ДиалогФыбораФайла.Выбрать() Тогда
		Элемент.Значение = ДиалогФыбораФайла.ПолноеИмяФайла;
	КонецЕсли;

КонецПроцедуры
