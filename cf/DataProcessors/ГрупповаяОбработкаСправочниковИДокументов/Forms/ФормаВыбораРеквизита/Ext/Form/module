
Процедура КнопкаВыполнитьНажатие(Элемент)
	ПриВыбореРеквизита(ЭлементыФормы.ДеревоРеквизитов.ТекущаяСтрока);
КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	Для Каждого ПолеНастройки Из ПоляНастройки Цикл
		Если ПолеНастройки.Имя = "Т_НомерСтроки" ИЛИ Лев(ПолеНастройки.ПутьКДанным,2) = "С_" ИЛИ Лев(ПолеНастройки.ПутьКДанным,2) = "К_" Или ПолеНастройки.Имя = "Ш_Вид" или ПолеНастройки.Имя = "Ш_Ссылка" Тогда
			Продолжить;
		КонецЕсли; 
		СтрокаРеквизита                  = ДеревоРеквизитов.Строки.Добавить();
		СтрокаРеквизита.Имя              = ПолеНастройки.Имя;
		СтрокаРеквизита.Представление    = ПолеНастройки.Представление;
		СтрокаРеквизита.ПолеНастройки    = ПолеНастройки;
		
		Для Каждого ПолеНастройки2 ИЗ ПолеНастройки.Поля Цикл
				СтрокаРеквизита2                = СтрокаРеквизита.Строки.Добавить();
				СтрокаРеквизита2.Имя            = ПолеНастройки2.Имя;
				СтрокаРеквизита2.Представление  = ПолеНастройки2.Представление;
				СтрокаРеквизита2.ПолеНастройки  = ПолеНастройки2;
		КонецЦикла;		
			
	КонецЦикла;
	
КонецПроцедуры

Процедура ДеревоРеквизитовВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	ПриВыбореРеквизита(ВыбраннаяСтрока);
КонецПроцедуры

Процедура ПриВыбореРеквизита(СтрокаДерева)
	
	Закрыть(Новый Структура("Имя, ПолеНастройки, Представление", СтрокаДерева.Имя, СтрокаДерева.ПолеНастройки, ?(СтрокаДерева.Уровень() = 1,СтрокаДерева.Родитель.Представление+".","")+СтрокаДерева.Представление));
КонецПроцедуры

ДеревоРеквизитов.Колонки.Добавить("Имя");
ДеревоРеквизитов.Колонки.Добавить("ПолеНастройки");