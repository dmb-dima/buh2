Перем мФормаВыбораПриказаОПриеме; // Форма для выбора подразделения организации

Процедура СписокФизическоеЛицоОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)

	СтрокаТЧ = ЭлементыФормы.РегистрСведенийСписок.ТекущиеДанные;

	Если СтрокаТЧ = Неопределено Тогда
		Возврат;
	КонецЕсли;

	Если ТипЗнч(ВыбранноеЗначение) = Тип("Структура") Тогда

		СтрокаТЧ.ФизическоеЛицо = ВыбранноеЗначение.ФизЛицо;
		СтрокаТЧ.Должность      = ВыбранноеЗначение.Должность;

	КонецЕсли;

КонецПроцедуры

Процедура СписокОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)

	Если ТипЗнч(ВыбранноеЗначение) <> Тип("Структура") Тогда
		Возврат;
	КонецЕсли;
	
	Элемент.ТекущиеДанные.ФизическоеЛицо = ВыбранноеЗначение.Физлицо;
	Элемент.ТекущиеДанные.Должность      = ВыбранноеЗначение.Должность;

	СтандартнаяОбработка = Ложь;

КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

Процедура ПриОткрытии()

	// Проверка однофирменности
	РаботаСДиалогами.УстановитьОтборПоОрганизации(ЭтаФорма,, глЗначениеПеременной("ОсновнаяОрганизация"), "РегистрСведенийСписок", Ложь, "СтруктурнаяЕдиница");
КонецПроцедуры

Процедура ОбработкаОповещения(ИмяСобытия, Параметр, Источник)
	
	Если ИмяСобытия = "ИзменениеТекущейОрганизации" Тогда
		РаботаСДиалогами.УстановитьОтборПоОрганизации(ЭтаФорма,, глЗначениеПеременной("ОсновнаяОрганизация"), "РегистрСведенийСписок", Истина, "СтруктурнаяЕдиница");
	КонецЕсли;
	
КонецПроцедуры

Процедура РегистрСведенийСписокПриНачалеРедактирования(Элемент, НоваяСтрока)

	Если НоваяСтрока Тогда

		СтрокаТЧ = ЭлементыФормы.РегистрСведенийСписок.ТекущиеДанные;
		
		Если ТипЗнч(ПараметрОтборПоИзмерению) = Тип("Структура") Тогда
			Если НЕ ЗначениеЗаполнено(ПараметрОтборПоИзмерению) Тогда
				СтрокаТЧ.Организация = глЗначениеПеременной("ОсновнаяОрганизация");
			КонецЕсли;
		КонецЕсли;
		
	КонецЕсли;

КонецПроцедуры







