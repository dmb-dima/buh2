
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

Процедура ПриОткрытии()

	Если ЗначениеЗаполнено(глЗначениеПеременной("глТекущийПользователь")) Тогда
		Отбор.ОбособленноеПодразделение.Значение = глЗначениеПеременной("ОсновнаяОрганизация");
	КонецЕсли;
	
	Отбор.Год.Значение = Год(ТекущаяДата());
	УстановитьОтборВРегистре();
	
КонецПроцедуры

Процедура ПриПовторномОткрытии(СтандартнаяОбработка)
	
	Если ЗначениеЗаполнено(глЗначениеПеременной("глТекущийПользователь")) Тогда
		Отбор.ОбособленноеПодразделение.Значение = глЗначениеПеременной("ОсновнаяОрганизация");
	КонецЕсли;
	
	Заголовок = "Суммы взносов формы СЗВ-4 организации " + Отбор.ОбособленноеПодразделение.Значение.Наименование;	
		
	Отбор.ОбособленноеПодразделение.Использование = Истина;
	
КонецПроцедуры

Процедура РегистрСведенийСписокПриНачалеРедактирования(Элемент, НоваяСтрока)

	Если НоваяСтрока Тогда
		
		СтрокаТЧ = ЭлементыФормы.РегистрСведенийСписок.ТекущиеДанные;
		СтрокаТЧ.СправочникСсылка.Организации = глЗначениеПеременной("ОсновнаяОрганизация");
		
	КонецЕсли;

КонецПроцедуры

Процедура ИспользованиеОтбораПоОрганизацииПриИзменении(Элемент)
	УстановитьОтборВРегистре();
КонецПроцедуры

Процедура ИспользованиеОтбораПоФизЛицуПриИзменении(Элемент)
	УстановитьОтборВРегистре();
КонецПроцедуры

Процедура ИспользованиеОтбораПоГодуПриИзменении(Элемент)
	 УстановитьОтборВРегистре();
КонецПроцедуры

Процедура ОрганизацияПриИзменении(Элемент)
	УстановитьОтборВРегистре();
КонецПроцедуры

Процедура ФизЛицоПриИзменении(Элемент)
	УстановитьОтборВРегистре();
КонецПроцедуры

Процедура ГодПриИзменении(Элемент)
	УстановитьОтборВРегистре();
КонецПроцедуры

// Процедура прописывает заголовок формы и устанавливает/отключает отбор.
//
Процедура УстановитьОтборВРегистре()
	Если НЕ ЭлементыФормы.Организация.Значение.Пустая() И ЭлементыФормы.ИспользованиеОтбораПоОрганизации.Значение Тогда
		Заголовок = "Суммы взносов формы СЗВ-4 организации " + ЭлементыФормы.Организация.Значение.Наименование;
		Отбор.ОбособленноеПодразделение.Использование = Истина;
	Иначе
		Заголовок = "Суммы взносов формы СЗВ-4";
		Отбор.ОбособленноеПодразделение.Использование = Ложь;
	КонецЕсли;
	
	Отбор.ФизЛицо.Использование = НЕ ЭлементыФормы.ФизЛицо.Значение.Пустая() И ЭлементыФормы.ИспользованиеОтбораПоФизЛицу.Значение;
	Отбор.Год.Использование =  ЭлементыФормы.Год.Значение <> 0 И ЭлементыФормы.ИспользованиеОтбораПоГоду.Значение;
КонецПроцедуры // УстановитьОтборВРегистре()
