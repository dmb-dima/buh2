////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ ОБЩЕГО НАЗНАЧЕНИЯ

Процедура ПриИзмененииДанных()

	Если РегистрСведенийНаборЗаписей.Модифицированность() Тогда
			
		Ответ = Вопрос("Записать значение ставок шкалы " + НРег(Отбор.ВидСтавокЕСНиПФР.Значение) + " на " + Формат(Отбор.Год.Значение, "ЧГ=") + " год?", РежимДиалогаВопрос.ДаНетОтмена);
		
		Если Ответ = КодВозвратаДиалога.Да Тогда
			Попытка
				РегистрСведенийНаборЗаписей.Записать(Истина);
			Исключение
				Год = Отбор.Год.Значение;
				ВидСтавокЕСНиПФР = Отбор.ВидСтавокЕСНиПФР.Значение;
				Возврат
			КонецПопытки;
		КонецЕсли;
			
	КонецЕсли;  
		
	Отбор.Год.Значение = Год;
	Отбор.ВидСтавокЕСНиПФР.Значение = ВидСтавокЕСНиПФР;
	
	РегистрСведенийНаборЗаписей.Прочитать();
    Заголовок = "Сведения о ставках ЕСН и ПФР по шкале " + НРег(ВидСтавокЕСНиПФР) + " на " + Формат(Год,"ЧГ=0") + " г.";
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

Процедура ПриОткрытии()

	Отбор.Год.Использование = Истина;
	Отбор.ВидСтавокЕСНиПФР.Использование = Истина;
	
	Год = Макс(2005,Год(РабочаяДата));
	ВидСтавокЕСНиПФР = Перечисления.ВидыСтавокЕСНиПФР.ДляНеСельскохозяйственныхПроизводителей;
	
	ПриИзмененииДанных();

КонецПроцедуры // ПриОткрытии()

Процедура ПриПовторномОткрытии(СтандартнаяОбработка)

    Год = Макс(2005,Год(РабочаяДата));
	ПриИзмененииДанных();

КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ РЕКВИЗИТОВ ФОРМЫ

Процедура ГодПриИзменении(Элемент)

	ПриИзмененииДанных();
		
КонецПроцедуры

Процедура ВидСтавокЕСНиПФРПриИзменении(Элемент)
	Если НЕ ЗначениеЗаполнено(Элемент.Значение) Тогда
		Элемент.Значение = Перечисления.ВидыСтавокЕСНиПФР.ДляНеСельскохозяйственныхПроизводителей
	КонецЕсли;	
	ПриИзмененииДанных();	
КонецПроцедуры

Процедура ДействияФормыЗаполнить(Кнопка)
	
	ЗаполнитьСведенияОСтавкахЕСНиПФР(ВидСтавокЕСНиПФР, Год, РегистрСведенийНаборЗаписей);
	
КонецПроцедуры


