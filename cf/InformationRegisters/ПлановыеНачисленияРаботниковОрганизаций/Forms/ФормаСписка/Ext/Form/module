// Процедура прописывает заголовок формы 
//
// Параметры:
//  Элемент - элемент формы, который отображает организацию
//  
Процедура ОрганизацияПриИзменении(Элемент)

	Заголовок = "Начисления работников организации " + ?(Элемент.Значение = Неопределено, "", Элемент.Значение.Наименование);
	Если Элемент.Значение = Неопределено Тогда
	    Отбор.Организация.Использование = Ложь
	Иначе
		Отбор.Организация.Использование = Не Элемент.Значение.Пустая();
	КонецЕсли; 
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Если форма открывается из списка документов, процедура заполняет организацию 
// прописывает заголовок формы и выставляет отбор регистру
//
Процедура ПриОткрытии()

	Если ЗначениеЗаполнено(ПараметрОтборПоРегистратору) Тогда

		МетаданныеДокумента = ПараметрОтборПоРегистратору.Метаданные();

		Если МетаданныеДокумента.Реквизиты.Найти("Организация") <> Неопределено Тогда

			Отбор.Организация.Значение = ПараметрОтборПоРегистратору.Организация;
			Заголовок                  = "Начисления работников организации " + Отбор.Организация.Значение.Наименование;
			ЭлементыФормы.Организация.ТолькоПросмотр = Истина;

		КонецЕсли;

		Отбор.Организация.Использование = Истина;

	Иначе

		Отбор.Организация.Значение      = глЗначениеПеременной("ОсновнаяОрганизация");
		Заголовок                       = "Начисления работников организации " + Отбор.Организация.Значение;
		Отбор.Организация.Использование = Не Отбор.Организация.Значение.Пустая();
		
	КонецЕсли;

КонецПроцедуры

Процедура ПриПовторномОткрытии(СтандартнаяОбработка)
	
	Если ЗначениеЗаполнено(ПараметрОтборПоРегистратору) Тогда
		
        МетаданныеДокумента = ПараметрОтборПоРегистратору.Метаданные();
		
		Если МетаданныеДокумента.Реквизиты.Найти("Организация") <> Неопределено Тогда
			
			Отбор.Организация.Значение = ПараметрОтборПоРегистратору.Организация;
			Заголовок = "Начисления работников организации " + Отбор.Организация.Значение.Наименование;
			ЭлементыФормы.Организация.ТолькоПросмотр = Истина;
			
        	Возврат
			
		КонецЕсли;

		Отбор.Организация.Использование = Истина;

	Иначе
		
		Отбор.Организация.Значение = глЗначениеПеременной("ОсновнаяОрганизация");
	    Отбор.Организация.Использование = Не Отбор.Организация.Значение.Пустая();
		
	КонецЕсли;
	
	Заголовок = "Начисления работников организации";
	ЭлементыФормы.Организация.ТолькоПросмотр = Ложь;
	
КонецПроцедуры
