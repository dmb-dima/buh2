Процедура СправочникСписокПередНачаломДобавления(Элемент, Отказ, Копирование, Родитель, ЭтоГруппа)

	МассивПолейОтбора = Новый Массив;
	МассивПолейОтбора.Добавить("Организация");
	МассивПолейОтбора.Добавить("ТипОплаты");
	
	Если НЕ Копирование и Не ЭтоГруппа Тогда

		Для Каждого ИмяПоляОтбора Из МассивПолейОтбора Цикл
			ОтборФормы = СправочникСписок.Отбор[ИмяПоляОтбора];
			Если ОтборФормы.Использование
			   И (ОтборФормы.ВидСравнения = ВидСравнения.Равно Или ОтборФормы.ВидСравнения = ВидСравнения.ВСписке) Тогда
				Отказ = Истина;
				Прервать;
			КонецЕсли;
		КонецЦикла;

		Если Отказ Тогда

			НовыйОбъект = Справочники.ВидыОплатОрганизаций.СоздатьЭлемент();

			Для Каждого ИмяПоляОтбора Из МассивПолейОтбора Цикл
				ОтборФормы = СправочникСписок.Отбор[ИмяПоляОтбора];
				Если ОтборФормы.Использование Тогда
					Если ОтборФормы.ВидСравнения = ВидСравнения.Равно Тогда
						НовыйОбъект[ИмяПоляОтбора] = ОтборФормы.Значение;
					ИначеЕсли ОтборФормы.ВидСравнения = ВидСравнения.ВСписке Тогда
						Если ОтборФормы.Значение.Количество() >  0 Тогда
							НовыйОбъект[ИмяПоляОтбора] = ОтборФормы.Значение[0].Значение;
						КонецЕсли;
					КонецЕсли;
				КонецЕсли
			КОнецЦикла;

			// Надо установить родителя
			НовыйОбъект.Родитель = Родитель;
			
			ФормаЭлемента = НовыйОбъект.ПолучитьФорму(,ЭлементыФормы.СправочникСписок);
			ФормаЭлемента.Открыть();
            									
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры // СправочникСписокПередНачаломДобавления()
                  

