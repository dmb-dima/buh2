Функция ДублирующиеИзмерение(ВыбранныйПутьКДанным)
	
	Для Сч = 0 По ПостроительОтчета.ИзмеренияСтроки.Количество() - 1  Цикл
		Если ВыбранныйПутьКДанным = ПостроительОтчета.ИзмеренияСтроки[Сч].ПутьКДанным Тогда
			Предупреждение("Повторяющееся поле детализации """ + ПостроительОтчета.ИзмеренияСтроки[Сч].Представление + """!");
			Возврат Истина;
			Прервать;
		КонецЕсли;
	КонецЦикла;
	
	Возврат Ложь;
	
КонецФункции

Процедура ДобавитьЭлементОтбораПостроителя(ИмяПоля)
	
	ЭлементОтбора = ПостроительОтчета.Отбор.Найти(ИмяПоля);
	Если ЭлементОтбора = Неопределено Тогда
		ЭлементОтбора = ПостроительОтчета.Отбор.Добавить(ИмяПоля);
	КонецЕсли;
	
КонецПроцедуры

Процедура КнопкаОКНажатие(Элемент)
	Закрыть(Истина);
КонецПроцедуры

Процедура КнопкаНастройкаПериодаНажатие(Элемент)

	РаботаСДиалогами.ОбработчикНастройкаПериодаНажатие(ДатаНач, ДатаКон);
	
КонецПроцедуры // КнопкаНастройкаПериодаНажатие()


Процедура ОтборЗначениеНачалоВыбора(Элемент, СтандартнаяОбработка)
	
	СтрокаОтбора = ЭлементыФормы.Отбор.ТекущиеДанные;
	Если СтрокаОтбора = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	// Принятая в конфигурации обработка работает только для равенства/неравенства
	Если СтрокаОтбора.ВидСравнения = ВидСравнения.Равно
		ИЛИ СтрокаОтбора.ВидСравнения = ВидСравнения.НеРавно Тогда
		
		ТипЗначенияПоля = СтрокаОтбора.ТипЗначения;
		НачалоВыбораЗначенияСубконто(Элемент, СтандартнаяОбработка, ТипЗначенияПоля);
		
	КонецЕсли;
	
КонецПроцедуры

Процедура ДетализацияПриОкончанииРедактирования(Элемент, НоваяСтрока, ОтменаРедактирования)
	
	Если (Элемент.ТекущиеДанные <> Неопределено) и (Не ОтменаРедактирования) Тогда
		ДобавитьЭлементОтбораПостроителя(Элемент.ТекущиеДанные.ПутьКДанным);
	КонецЕсли;
		
КонецПроцедуры

Процедура ДетализацияПолеОбработкаВыбора(Элемент, ВыбранноеЗначение, СтандартнаяОбработка)
	
	Если ВыбранноеЗначение <> ЭлементыФормы.Детализация.ТекущиеДанные.ПутьКДанным Тогда
		СтандартнаяОбработка = Не ДублирующиеИзмерение(ВыбранноеЗначение);
	КонецЕсли;
	
КонецПроцедуры