//Обновляем таблицы отчета
Процедура ОбновитьОтчет() Экспорт
	
	НеЗаполнятьНастройкиПриОткрытии = Не Открыта();
	
	СформироватьОбложкуЖурналаКассовыхДокументов(ЭлементыФормы.Обложка);
	СформироватьЖурналКассовыхДокументов(ЭлементыФормы.ДокументРезультат);
	
КонецПроцедуры // ОбновитьОтчет()

///////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Процедура - обработчик события "При открытии" формы отчета.
Процедура ПриОткрытии()
	
	Если Не НеЗаполнятьНастройкиПриОткрытии Тогда 
		Организация = глЗначениеПеременной("ОсновнаяОрганизация");
	КонецЕсли;
	
	Если НЕ НеЗаполнятьНастройкиПриОткрытии Тогда
		ДатаНач=НачалоДня(РабочаяДата);
		ДатаКон=КонецДня(РабочаяДата);
		
		Если ТипЗнч(СохраняемыеРеквизиты) = Тип("Структура") Тогда 
			СохраняемыеРеквизиты.Свойство("Организация", Организация);
			СохраняемыеРеквизиты.Свойство("ГруппироватьПоДатам", ГруппироватьПоДатам);	
		КонецЕсли;
		
	КонецЕсли;
	
	 НеЗаполнятьНастройкиПриОткрытии = Ложь;
	 
 КонецПроцедуры // ПриОткрытии()
 
 
 Процедура ПередСохранениемЗначений(Отказ)
		
	СохраняемыеРеквизиты = Новый Структура("Организация, ГруппироватьПоДатам");

	СохраняемыеРеквизиты.Вставить("Организация", Организация);	
	СохраняемыеРеквизиты.Вставить("ГруппироватьПоДатам", ГруппироватьПоДатам);
	
КонецПроцедуры

Процедура ПослеВосстановленияЗначений()
		
	// Если настройка восстанавливается, когда открывается форма сформированного отчета, игнорируем
	Если НеЗаполнятьНастройкиПриОткрытии Тогда
		Возврат;
	КонецЕсли;
	
	// Тип восстановленного значения должен быть Структура
	Если НЕ ТипЗнч(СохраняемыеРеквизиты) = Тип("Структура") Тогда 
		Возврат;
	КонецЕсли;
	
	СохраняемыеРеквизиты.Свойство("Организация", Организация);
	СохраняемыеРеквизиты.Свойство("ГруппироватьПоДатам", ГруппироватьПоДатам);	
	
КонецПроцедуры
    

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ КОМАНДНЫХ ПАНЕЛЕЙ

// Процедура-обработчик события нажатия кнопки "Сформировать"
Процедура ДействияФормыСформировать(Кнопка)
	
	ОбновитьОтчет()
		
КонецПроцедуры

// Процедура-обработчик события нажатия кнопки "..."
Процедура КнопкаНастройкаПериодаНажатие(Элемент)
	
	РаботаСДиалогами.ОбработчикНастройкаПериодаНажатие(ДатаНач, ДатаКон);
	
КонецПроцедуры

