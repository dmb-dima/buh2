

Процедура ОсновныеДействияФормыОсновныеДействияФормыОК(Кнопка)
	//избавляемся от пустых строк
	//сворачиваем
	Документы.Свернуть("Дата, Номер, Серия");
	//удаляем последнюю
	Для каждого Строка Из Документы Цикл
		Если НЕ ЗначениеЗаполнено(Строка.Дата) И НЕ ЗначениеЗаполнено(Строка.Номер) И НЕ ЗначениеЗаполнено(Строка.Серия) Тогда
	    	Документы.Удалить(Строка);
			Прервать;
		КонецЕсли;
	КонецЦикла;

	//Проверка заполнения
	Для каждого Строка Из Документы Цикл
		Если НЕ ЗначениеЗаполнено(Строка.Дата) ИЛИ НЕ ЗначениеЗаполнено(Строка.Номер + Строка.Серия) Тогда
			НомерСтроки = Документы.Индекс(Строка) + 1;
			Сообщить("Требуется дозаполнить строку " + НомерСтроки + ".");
			Возврат;
		КонецЕсли;
	КонецЦикла;
	
	Закрыть(Документы);
КонецПроцедуры


Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	ЭлементыФормы.Документы.СоздатьКолонки();
КонецПроцедуры

