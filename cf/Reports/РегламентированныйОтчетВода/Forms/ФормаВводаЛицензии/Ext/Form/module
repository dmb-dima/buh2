Перем БылаНажатаКнопкаОК;

Процедура КнопкаОКНажатие(Кнопка)

	БылаНажатаКнопкаОК = Истина;

	Закрыть();

КонецПроцедуры

// СформироватьПредставление
//
Процедура СформироватьПредставление()

	Серия = ЭлементыФормы.ПолеВводаСерия.Значение;
	Номер = РегламентированнаяОтчетность.ДополнитьСтроку(СокрП(ЭлементыФормы.ПолеВводаНомер.Значение), 5, "0");
	Вид = РегламентированнаяОтчетность.ДополнитьСтроку(ЭлементыФормы.ПолеВводаВид.Значение, 6, " ", 1);

	Если РегламентированнаяОтчетность.ПустоеЗначение(Серия) И РегламентированнаяОтчетность.ПустоеЗначение(Вид) И РегламентированнаяОтчетность.ПустоеЗначение(ЭлементыФормы.ПолеВводаНомер.Значение) Тогда
		ЭлементыФормы.ПолеВводаПредставление.Значение = "";
	Иначе

		Представление = ЭлементыФормы.ПолеВводаСерия.Значение + ";" + Номер + ";" + Вид;
		ЭлементыФормы.ПолеВводаПредставление.Значение = Представление;

	КонецЕсли;


КонецПроцедуры // СформироватьПредставление

Процедура ПолеВводаСерияПриИзменении(Элемент)

	Элемент.Значение = РегламентированнаяОтчетность.ДополнитьСтроку(СтрЗаменить(Элемент.Значение, ";", ""), 3, " ");
	СформироватьПредставление();

КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	Если НЕ РегламентированнаяОтчетность.ПустоеЗначение(НачальноеЗначениеВыбора) Тогда
		// Если в строке уже есть два символа ;, считаем, что строка удовлетворяет формату
		Если СтрЧислоВхождений(НачальноеЗначениеВыбора, ";") = 2 Тогда
			НачЗначение = СокрЛП(НачальноеЗначениеВыбора);
			НачЗначение = СтрЗаменить(НачЗначение, ";", Символы.ПС);
			Серия = СтрПолучитьСтроку(НачЗначение, 1);
			Номер = СтрПолучитьСтроку(НачЗначение, 2);
			Вид = СтрПолучитьСтроку(НачЗначение, 3);
			ЭлементыФормы.ПолеВводаСерия.Значение = Серия;
			ЭлементыФормы.ПолеВводаНомер.Значение = Номер;
			ЭлементыФормы.ПолеВводаВид.Значение = Вид;
			СформироватьПредставление();
		Иначе
			ЭлементыФормы.ПолеВводаПредставление.Значение = НачальноеЗначениеВыбора;
			Сообщить("Необходимо ввести серию, номер и вид лицензии в соответствии с правилами ввода реквизитов лицензии");
		КонецЕсли;
	КонецЕсли;

	БылаНажатаКнопкаОК = Ложь;

КонецПроцедуры

Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)

	Отказ = Истина;
	Закрыть(БылаНажатаКнопкаОК);

КонецПроцедуры

Процедура ПриЗакрытии()

	Если НЕ БылаНажатаКнопкаОк Тогда

		Возврат;

	КонецЕсли;

	НачальноеЗначениеВыбора = ЭлементыФормы.ПолеВводаПредставление.Значение;

КонецПроцедуры

Процедура ПолеВводаНомерПриИзменении(Элемент)

	СформироватьПредставление();

КонецПроцедуры

Процедура ПолеВводаВидПриИзменении(Элемент)

	СформироватьПредставление();

КонецПроцедуры

Процедура КоманднаяПанель1Очистить(Кнопка)

	ЭлементыФормы.ПолеВводаВид.Значение = "";
	ЭлементыФормы.ПолеВводаНомер.Значение = "";
	ЭлементыФормы.ПолеВводаСерия.Значение = "   ";
	СформироватьПредставление();

КонецПроцедуры
