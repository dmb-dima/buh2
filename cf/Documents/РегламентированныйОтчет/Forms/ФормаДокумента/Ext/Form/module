////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

// Процедура - обработчик события "ПередОткрытием" формы.
//
Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)

	// вместо формы документа открываем форму связанного с ним отчета
	Отказ = Истина;

	Если Не(ЭтоНовый()) ИЛИ (мСкопированаФорма <> Неопределено) Тогда
		
		ПравоДоступаКОтчету = РегламентированнаяОтчетность.ПравоДоступаКРегламентированномуОтчету(ИсточникОтчета);
		Если ПравоДоступаКОтчету = Ложь Тогда
			Предупреждение("Недостаточно прав!");
			Возврат;
		ИначеЕсли ПравоДоступаКОтчету = Неопределено Тогда
			Предупреждение("Не удалось открыть сохраненные данные! Отчет не найден!");
			Возврат;
		КонецЕсли;
		
		ОбъектОтчет = РегламентированнаяОтчетность.РеглОтчеты(ИсточникОтчета);
		Если ОбъектОтчет = Неопределено Тогда
			Сообщить("Не удалось открыть сохраненные данные! Отчет не найден!", СтатусСообщения.Важное);
			Возврат;
		КонецЕсли;
		
		ВыбФормаОтчета = ОбъектОтчет.ПолучитьФорму( ,ЭтаФорма);
		
		// обход ошибки, присутствующей в 8.2.9
		Если ВыбФормаОтчета.ОбработкаОбъект <> ОбъектОтчет Тогда
			ВыбФормаОтчета.ОбработкаОбъект = ОбъектОтчет;
		КонецЕсли;
		
		ВыбФормаОтчета.РежимВыбора = Ложь;
		ВыбФормаОтчета.ЗакрыватьПриЗакрытииВладельца = Ложь;
		ВыбФормаОтчета.Открыть();
		
	ИначеЕсли ЭтоНовый() Тогда
		Справочники.РегламентированныеОтчеты.ПолучитьФормуСписка().Открыть();
	КонецЕсли;

КонецПроцедуры // ПередОткрытием()
