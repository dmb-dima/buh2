Перем ОтказОтЗаписи;

Процедура ОсновныеДействияФормыОК(Кнопка)
	
	Если ОтражатьВБУ <> ДокументОбъект.ОтражатьВБухгалтерскомУчете Тогда
		ДокументОбъект.ОтражатьВБухгалтерскомУчете = ОтражатьВБУ;
	КонецЕсли;
	
	Если ОтражатьВНУ <> ДокументОбъект.ОтражатьВНалоговомУчете Тогда
		ДокументОбъект.ОтражатьВНалоговомУчете = ОтражатьВНУ;
	КонецЕсли;
	
	Если ОтражатьВСР <> ДокументОбъект.ОтражатьПоСпециальнымРегистрам Тогда
		ДокументОбъект.ОтражатьПоСпециальнымРегистрам = ОтражатьВСР;
	КонецЕсли;
	
	ЭтаФорма.Модифицированность = Ложь;
	ЭтаФорма.Закрыть();
	
КонецПроцедуры

Процедура ПередЗакрытием(Отказ, СтандартнаяОбработка)
	
	СтандартнаяОбработка = Ложь;
	
КонецПроцедуры

Процедура ПриОткрытии()
	
	ОтражатьВБУ = ДокументОбъект.ОтражатьВБухгалтерскомУчете;
	ОтражатьВНУ = ДокументОбъект.ОтражатьВНалоговомУчете;
	ОтражатьВСР = ДокументОбъект.ОтражатьПоСпециальнымРегистрам;
	
	ПоказатьСправку();
	
КонецПроцедуры

Процедура ПоказатьСправку()
	
	МакетПомощника = ПолучитьМакет("СправкаНастройки");
	
	ОбластьТекстЗаголовок			= "Заголовок|Текст";
	ОбластьТекстаСправки = МакетПомощника.ПолучитьОбласть(ОбластьТекстЗаголовок);
	ТекстЗаголовок = ОбластьТекстаСправки.ТекущаяОбласть.Текст;
	
	ОбластьТекстОбщий			= "Строка|Текст";
	ОбластьТекстаСправки = МакетПомощника.ПолучитьОбласть(ОбластьТекстОбщий);
		ТекстОбщий = ОбластьТекстаСправки.ТекущаяОбласть.Текст + "
															  |";
	ЦветФонаСправки		= РаботаСДиалогами.ВернутьШестнадцатиричноеПредставлениеЦвета(РаботаСДиалогами.ВстроеннаяСправка_ЦветФона());
	ЦветСсылкиСправки	= РаботаСДиалогами.ВернутьШестнадцатиричноеПредставлениеЦвета(РаботаСДиалогами.ВстроеннаяСправка_ЦветСсылки());
	
		ТекстВстроеннойСправки = 
	"<HTML>
	|	<HEAD>
	|		<META http-equiv=Content-Type content=""text/html; charset=utf-8"">" + РаботаСДиалогами.ВстроеннаяСправка_СтилиДокумента() + "
	|	</HEAD>
	|	<BODY aLink="+ЦветСсылкиСправки+" vLink="+ЦветСсылкиСправки+" link="+ЦветСсылкиСправки+" bgColor="+ЦветФонаСправки+" scroll=auto>
	|		<IMG src="+РаботаСДиалогами.ПолучитьПутьККартинкеДляHTML(БиблиотекаКартинок.КартинкаВстроеннойСправкиФормы, ЭлементыФормы.ВстроеннаяСправка)+">
	|		<DIV class=""top"" id=true style=""DISPLAY:inline"">
	|			<DIV><STRONG>" + ТекстЗаголовок + "</STRONG></DIV>
	|		</DIV>";
	
	Если СтрЧислоСтрок(ТекстОбщий) > 0 Тогда
		Для НомСтроки = 1 По СтрЧислоСтрок(ТекстОбщий) Цикл
			ТекстСправки = СтрПолучитьСтроку(ТекстОбщий,НомСтроки);
			ТекстВстроеннойСправки = ТекстВстроеннойСправки + "
			|	<DIV>" + ТекстСправки + "</DIV>";
		КонецЦикла;
	КонецЕсли;
	
	ТекстВстроеннойСправки = ТекстВстроеннойСправки + "
	|	</BODY>
	|</HTML>";
		
	ЭлементыФормы.ВстроеннаяСправка.УстановитьТекст(ТекстВстроеннойСправки);
	
КонецПроцедуры





